<!-- Event Context Menu -->
<div
  x-show="ctxMenu.open"
  x-cloak
  @click.outside="ctxMenu.open = false"
  @keydown.escape.window="ctxMenu.open = false"
  class="fixed z-[100] shadow-xl bg-base-100 border border-base-300 rounded-lg w-56 p-1"
  :style="`top: ${ctxMenu.y}px; left: ${ctxMenu.x}px;`"
>
  <ul class="menu menu-sm p-0">
    <!-- View details -->
    <li>
      <button type="button" class="gap-3 rounded" @click="ctxMenuAction('view')">
        <i data-lucide="eye" class="w-4 h-4"></i>
        <span>View details</span>
      </button>
    </li>

    <!-- Copy link -->
    <li>
      <button type="button" class="gap-3 rounded" @click="ctxMenuAction('copy_link')">
        <i data-lucide="link" class="w-4 h-4"></i>
        <span>Copy link</span>
      </button>
    </li>

    <!-- Owner actions -->
    <hr x-show="ctxMenu.isOwner" class="my-1 border-base-300" />
    <li x-show="ctxMenu.isOwner">
      <button type="button" class="gap-3 rounded" @click="ctxMenuAction('edit')">
        <i data-lucide="pencil" class="w-4 h-4"></i>
        <span>Edit</span>
      </button>
    </li>
    <li x-show="ctxMenu.isOwner">
      <button type="button" class="gap-3 rounded text-error" @click="ctxMenuAction('delete')">
        <i data-lucide="trash-2" class="w-4 h-4"></i>
        <span>Delete</span>
      </button>
    </li>

    <!-- Invitee actions -->
    <hr x-show="!ctxMenu.isOwner && ctxMenu.inviteStatus !== null" class="my-1 border-base-300" />
    <li x-show="!ctxMenu.isOwner && ctxMenu.inviteStatus !== null && ctxMenu.inviteStatus !== 'accepted'">
      <button type="button" class="gap-3 rounded text-success" @click="ctxMenuAction('accept')">
        <i data-lucide="check" class="w-4 h-4"></i>
        <span>Accept</span>
      </button>
    </li>
    <li x-show="!ctxMenu.isOwner && ctxMenu.inviteStatus !== null && ctxMenu.inviteStatus !== 'declined'">
      <button type="button" class="gap-3 rounded text-error" @click="ctxMenuAction('decline')">
        <i data-lucide="x" class="w-4 h-4"></i>
        <span>Decline</span>
      </button>
    </li>
  </ul>
</div>
