<!-- Image Viewer -->
<div class="flex flex-col h-full" x-data="imageViewerData()">
  <!-- Toolbar -->
  <div class="flex items-center justify-center gap-2 p-4 bg-base-100 border-b border-base-300">
    <button type="button" class="btn btn-sm btn-ghost" @click="zoom(-0.2)" title="Zoom out (-)">
      <i data-lucide="zoom-out" class="w-4 h-4"></i>
    </button>
    <span class="text-sm font-mono min-w-[4rem] text-center" x-text="Math.round(zoomLevel * 100) + '%'"></span>
    <button type="button" class="btn btn-sm btn-ghost" @click="zoom(0.2)" title="Zoom in (+)">
      <i data-lucide="zoom-in" class="w-4 h-4"></i>
    </button>
    <div class="divider divider-horizontal mx-2"></div>
    <button type="button" class="btn btn-sm btn-ghost" @click="rotate(90)" title="Rotate (R)">
      <i data-lucide="rotate-cw" class="w-4 h-4"></i>
    </button>
    <button type="button" class="btn btn-sm btn-ghost" @click="reset()" title="Reset (0)">
      <i data-lucide="refresh-cw" class="w-4 h-4"></i>
    </button>
  </div>

  <!-- Image Container -->
  <div class="flex-1 overflow-auto flex items-center justify-center p-4 min-h-0">
    <img
      src="{{ content_url }}"
      alt="{{ file.name }}"
      class="max-w-full max-h-full object-contain transition-transform duration-200"
      :style="`transform: scale(${zoomLevel}) rotate(${rotation}deg)`"
      x-ref="image"
    />
  </div>
</div>

<script>
window.imageViewerData = function imageViewerData() {
  return {
    zoomLevel: 1,
    rotation: 0,

    init() {
      this.$nextTick(() => {
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
      });
    },

    zoom(delta) {
      this.zoomLevel = Math.max(0.1, Math.min(5, this.zoomLevel + delta));
    },

    rotate(degrees) {
      this.rotation = (this.rotation + degrees) % 360;
    },

    reset() {
      this.zoomLevel = 1;
      this.rotation = 0;
    }
  };
};
</script>
